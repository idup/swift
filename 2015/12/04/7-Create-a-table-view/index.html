<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/><meta content="telephone=no" name="format-detection"/><meta name="description"/><title>七. 创建表视图 | iOS应用开发</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"/><link rel="stylesheet" type="text/css" href="/css/pure-min.css"/><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css"/><link rel="stylesheet" type="text/css" href="/css/style.css"/><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"/><link rel="alternate" type="application/atom+xml" href="/atom.xml"/></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">七. 创建表视图</h1><a id="logo" href="/">iOS应用开发</a><p class="description">用Swift语言写FoodTracker</p></div><div id="nav-menu"><a href="/" class="current"><i class="icon-home"> 首页</i></a><a href="/archives/"><i class="icon-archive"> 归档</i></a><a href="/about/"><i class="icon-about"> 关于</i></a><a href="/atom.xml"><i class="icon-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">七. 创建表视图</h1><div class="post-meta">2015-12-04 | </div><div class="post-content"><h3 id="创建开放视图">创建开放视图</h3><p>目前，FoodTracker app只有一个通过view controller管理的视图，还需要创建meals的列表，IOS内置了表视图类UITableView来展示这种项目滑动列表</p>
<h5 id="在storyboard中添加一个表视图">在storyboard中添加一个表视图</h5><p>在Object libray中找到Table View Controller对象，拖拽它把它放置在meal视图的左边，这时就有两个视图，一个用来用来添加meal，一个用来展示meal 列表</p>
<h5 id="将table_view_controller设置为初始视图">将table view controller设置为初始视图</h5><p>拖拽指向view Controller的箭头，将它指向table view controller</p>
<p><img src="/images/7-1.png" alt=""></p>
<p><img src="/images/7-2.png" alt=""></p>
<p>运行虚拟机</p>
<p><img src="/images/7-3.png" alt=""></p>
<h5 id="配置table_view">配置table view</h5><p>在 outline view中选择Table View，打开Size inspector,找到Row Height标签，设置为90</p>
<p><img src="/images/7-4.png" alt=""></p>
<h3 id="设计自定义的表单元">设计自定义的表单元</h3><h5 id="创建UITableViewCell的子类">创建UITableViewCell的子类</h5><p>依次点击File &gt; New &gt; File ，选择ios下面的Source选项，选择 Cocoa Touch Class，点击next，Class中填入Meal,subclass of中选择UITableViewCell，然后一只默认设置到创建结束。</p>
<h5 id="为table_view配置自定义单元">为table view配置自定义单元</h5><p>在outline中选择Table View Cell，打开它的Attributes inspector，找到 Identifier标签，输入MealTableViewCell。找到 Selection标签，选择None，打开 Size inspector，找到Row Height标签，输入90，打开Identity inspector，在Class标签中选择 MealTableViewCell.</p>
<h5 id="为自定义的table单元设计接口">为自定义的table单元设计接口</h5><p>依次点击 Editor &gt; Canvas &gt; Show Bounds Rectangles，</p>
<p><img src="/images/7-5.png" alt=""></p>
<p>在Object library中选择Image View，拖拽它到表单元</p>
<p><img src="/images/7-6.png" alt=""></p>
<p>打开image view的 Attributes inspector,选择 Image标签设置为defaultPhoto，在Object library中选择Label，拖拽它到表单元，挡在image view的右边</p>
<p><img src="/images/7-7.png" alt=""></p>
<p>重新设置label的大小</p>
<p><img src="/images/7-8.png" alt=""></p>
<p>从Object library中选择View ，拖拽到表单元，打开它的Size inspector,设置 Height和Width 分别为40，240，打开它的Identity inspector，设置 Class为RatingControl。打开Attributes inspector，找到 Interaction标签，撤销User Interaction Enabled</p>
<p><img src="/images/7-9.png" alt=""></p>
<p><img src="/images/7-10.png" alt=""></p>
<p>运行虚拟机</p>
<p><img src="/images/7-11.png" alt=""></p>
<h3 id="向项目中添加图片">向项目中添加图片</h3><p>打开 project navigator中的Assets.xcassets，添加一个文件夹，命名为Sample Images，在这个文件夹下添加New Image Set ，向其中添加图片。可以新建多个New Image Set。</p>
<p><img src="/images/7-12.png" alt=""></p>
<h3 id="table单元和代码建立连接">table单元和代码建立连接</h3><h5 id="建立视图和MealTableViewCell-swift代码的连接">建立视图和MealTableViewCell.swift代码的连接</h5><p>拖拽table 单元中的label到MealTableViewCell.swift的代码区，name 设置为nameLabel</p>
<p><img src="/images/7-13.png" alt=""></p>
<p><img src="/images/7-14.png" alt=""></p>
<p>拖拽table单元中的image view到 MealTableViewCell.swift代码区，位置放在刚刚建立的nameLabel属性下面，name设置为photoImageView</p>
<p><img src="/images/7-15.png" alt=""></p>
<p>选择table view单元中的rating control，拖拽它到MealTableViewCell.swift代码区的photoImageView属性下。name设置为ratingControl</p>
<p><img src="/images/7-16.png" alt=""></p>
<p><img src="/images/7-17.png" alt=""></p>
<h3 id="加载初始数据">加载初始数据</h3><h5 id="创建UITableViewController的子类">创建UITableViewController的子类</h5><p>依次点击File &gt; New &gt; File，选择ios下的Source选项，选择Cocoa Touch Class，点击next,Class填入Meal,subclass of填入UITableViewController，确保Also create XIB file设置为unselected状态，点击创建。</p>
<h5 id="加载初始数据-1">加载初始数据</h5><p>在 MealTableViewController.swift代码区的class行下面添加如下代码</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// MARK: Properties</span><br><span class="line"></span><br><span class="line">var meals = [<span class="link_label">Meal</span>](<span class="link_url"></span>)</span><br></pre></td></tr></table></figure>
<p>在viewDidLoad() 方法后面，添加如下方法<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">func loadSampleMeals() &#123;</span><br><span class="line">    let photo1 = UIImage(<span class="string">named:</span> <span class="string">"meal1"</span>)!</span><br><span class="line">    let meal1 = Meal(<span class="string">name:</span> <span class="string">"Caprese Salad"</span>, <span class="string">photo:</span> photo1, <span class="string">rating:</span> <span class="number">4</span>)!</span><br><span class="line"></span><br><span class="line">    let photo2 = UIImage(<span class="string">named:</span> <span class="string">"meal2"</span>)!</span><br><span class="line">    let meal2 = Meal(<span class="string">name:</span> <span class="string">"Chicken and Potatoes"</span>, <span class="string">photo:</span> photo2, <span class="string">rating:</span> <span class="number">5</span>)!</span><br><span class="line"></span><br><span class="line">    let photo3 = UIImage(<span class="string">named:</span> <span class="string">"meal3"</span>)!</span><br><span class="line">    let meal3 = Meal(<span class="string">name:</span> <span class="string">"Pasta with Meatballs"</span>, <span class="string">photo:</span> photo3, <span class="string">rating:</span> <span class="number">3</span>)!</span><br><span class="line"></span><br><span class="line">    meals += [meal1, meal2, meal3]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>viewDidLoad()方法添加相关代码加载数据</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Load the sample data.</span></span><br><span class="line">    loadSampleMeals()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="呈现数据">呈现数据</h3><h5 id="呈现table_view的部分">呈现table view的部分</h5><p>修改MealTableViewController.swift代码中numberOfSectionsInTableView(_:)方法</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> meals.<span class="built_in">count</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="配置并呈现table_view中的单元">配置并呈现table view中的单元</h5><p>找到tableviewf方法将其改成如下形式</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span> &#123;</span><br><span class="line">    <span class="comment">// Table view cells are reused and should be dequeued using a cell identifier.</span></span><br><span class="line">    <span class="keyword">let</span> cellIdentifier = <span class="string">"MealTableViewCell"</span></span><br><span class="line">    <span class="keyword">let</span> cell = tableView.dequeueReusableCellWithIdentifier(cellIdentifier, forIndexPath: indexPath) <span class="keyword">as</span>! <span class="type">MealTableViewCell</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Fetches the appropriate meal for the data source layout.</span></span><br><span class="line">    <span class="keyword">let</span> meal = meals[indexPath.row]</span><br><span class="line"></span><br><span class="line">    cell.nameLabel.text = meal.name</span><br><span class="line">    cell.photoImageView.image = meal.photo</span><br><span class="line">    cell.ratingControl.rating = meal.rating</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cell</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="将table_view_controller_scene指向MealTableViewController-swift">将table view controller scene指向MealTableViewController.swift</h5><p>点击view controller的scene dock,打开Identity inspector，class标签选择MealTableViewController.</p>
<p><img src="/images/7-18.png" alt=""></p>
<h3 id="准备导航视图">准备导航视图</h3><h5 id="清理工程中无用的项目">清理工程中无用的项目</h5><p>选择Meal Name 标签，并删除它</p>
<p><img src="/images/7-19.png" alt=""></p>
<p><img src="/images/7-20.png" alt=""></p>
<p>打开ViewController.swift，找到 textFieldDidEndEditing(_:)方法，删除方法中的如下代码<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mealNameLabel.<span class="keyword">text</span> = <span class="keyword">textField</span>.<span class="keyword">text</span></span><br></pre></td></tr></table></figure></p>
<p>删除ViewController.swift中的<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> mealNameLabel: <span class="type">UILabel</span>!</span><br></pre></td></tr></table></figure></p>
<h5 id="重命名ViewController-swift文件">重命名ViewController.swift文件</h5><p>点击ViewController.swift，重命名为MealViewController.swift，将代码区的类声明作如下修改</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MealViewController</span>: <span class="typename">UIViewController</span>, <span class="typename">UITextFieldDelegate</span>, <span class="typename">UIImagePickerControllerDelegate</span>, <span class="typename">UINavigationControllerDelegate &#123;</span></span></span><br></pre></td></tr></table></figure>
<p>在文件的上面部分将ViewController.swift 改为MealViewController.swift.</p>
<p>点击meal secen的scene dock，打开Identity inspector，将class改为MealViewController</p>
</div><div class="tags"></div><div class="post-nav"><a href="/2015/12/04/8-Implement-navigation/" class="pre"><i class="icon-previous">八. 实现导航</i></a><a href="/2015/12/04/6-Define-your-data-model/" class="next">六. 定义数据模型<i class="icon-next"></i></a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><div id="search"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://ios-app.idup.club"></form></div></div><div class="widget"><div class="widget-title">分类</div></div><div class="widget"><div class="widget-title">标签</div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title">最新文章</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2015/12/04/10-Persist-data/">十. 持久化数据</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/04/9-Implement-edit-and-delete-behavior/">九. 实现编辑和删除操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/04/8-Implement-navigation/">八. 实现导航</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/04/7-Create-a-table-view/">七. 创建表视图</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/04/6-Define-your-data-model/">六. 定义数据模型</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/04/5-Implement-a-custom-control/">五. 实现自定义控件</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/04/4-Work-with-view-controllers/">四. 编写视图控制器</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/04/3-Connect-the-UI-to-code/">三. 连接界面与代码</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/04/2-Build-a-basic-UI/">二. 创建基本用户界面</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/04/1-Jump-Right-in/">一. 创建工程</a></li></ul></div><div class="widget"><div class="widget-title">友情链接</div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div></div><div id="footer">© <a href="/" rel="nofollow">iOS应用开发.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><a id="rocket" href="#top" class="show"></a><script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/totop.js" type="text/javascript"></script><script src="/js/fancybox.pack.js" type="text/javascript"></script>
<script src="/js/jquery.fancybox.js" type="text/javascript"></script><link rel="stylesheet" href="/css/jquery.fancybox.css" type="text/css"></div></body></html>